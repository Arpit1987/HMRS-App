name: AI PR Review

on:
  pull_request:
    types: [opened, synchronize, reopened]

permissions:
  contents: read
  pull-requests: write

jobs:
  java-code-review:
    name: Java Code Review
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Create PR Review
      run: |
        echo "## ðŸ” Java Code Review - TestAiReview.java" > review.md
        echo "" >> review.md
        echo "### âŒ Critical Issues" >> review.md
        echo "" >> review.md
        echo "**1. Poor validation in add method**" >> review.md
        echo "- Missing input validation for parameters" >> review.md
        echo "- No integer overflow bounds checking" >> review.md
        echo "- Consider adding null checks and range validation" >> review.md
        echo "" >> review.md
        echo "**2. Incorrect string concatenation**" >> review.md
        echo "- \`System.out.println(\"Adding numbers: \" + a + b)\` will concatenate incorrectly" >> review.md
        echo "- Should be: \`\"Adding numbers: \" + (a + b)\` or use \`String.format()\`" >> review.md
        echo "" >> review.md
        echo "**3. No divide-by-zero handling**" >> review.md
        echo "- Method will throw \`ArithmeticException\` when b=0" >> review.md
        echo "- Add validation: \`if (b == 0) throw new IllegalArgumentException(\"Divisor cannot be zero\")\`" >> review.md
        
        gh pr review ${{ github.event.pull_request.number }} --body-file review.md --event REQUEST_CHANGES
        echo "âœ… PR review submitted!"
        
      env:
        GH_TOKEN: ${{ github.token }}